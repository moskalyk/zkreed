{"ast":null,"code":"\"use strict\";\n/* eslint-disable prefer-destructuring */\n\n/* eslint-disable no-param-reassign */\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n\n  return to;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Address6 = void 0;\n\nvar common = __importStar(require(\"./common\"));\n\nvar constants4 = __importStar(require(\"./v4/constants\"));\n\nvar constants6 = __importStar(require(\"./v6/constants\"));\n\nvar helpers = __importStar(require(\"./v6/helpers\"));\n\nvar ipv4_1 = require(\"./ipv4\");\n\nvar regular_expressions_1 = require(\"./v6/regular-expressions\");\n\nvar address_error_1 = require(\"./address-error\");\n\nvar jsbn_1 = require(\"jsbn\");\n\nvar sprintf_js_1 = require(\"sprintf-js\");\n\nfunction assert(condition) {\n  if (!condition) {\n    throw new Error('Assertion failed.');\n  }\n}\n\nfunction addCommas(number) {\n  var r = /(\\d+)(\\d{3})/;\n\n  while (r.test(number)) {\n    number = number.replace(r, '$1,$2');\n  }\n\n  return number;\n}\n\nfunction spanLeadingZeroes4(n) {\n  n = n.replace(/^(0{1,})([1-9]+)$/, '<span class=\"parse-error\">$1</span>$2');\n  n = n.replace(/^(0{1,})(0)$/, '<span class=\"parse-error\">$1</span>$2');\n  return n;\n}\n/*\n * A helper function to compact an array\n */\n\n\nfunction compact(address, slice) {\n  var s1 = [];\n  var s2 = [];\n  var i;\n\n  for (i = 0; i < address.length; i++) {\n    if (i < slice[0]) {\n      s1.push(address[i]);\n    } else if (i > slice[1]) {\n      s2.push(address[i]);\n    }\n  }\n\n  return s1.concat(['compact']).concat(s2);\n}\n\nfunction paddedHex(octet) {\n  return sprintf_js_1.sprintf('%04x', parseInt(octet, 16));\n}\n\nfunction unsignByte(b) {\n  // eslint-disable-next-line no-bitwise\n  return b & 0xff;\n}\n/**\n * Represents an IPv6 address\n * @class Address6\n * @param {string} address - An IPv6 address string\n * @param {number} [groups=8] - How many octets to parse\n * @example\n * var address = new Address6('2001::/32');\n */\n\n\nvar Address6 =\n/** @class */\nfunction () {\n  function Address6(address, optionalGroups) {\n    this.addressMinusSuffix = '';\n    this.parsedSubnet = '';\n    this.subnet = '/128';\n    this.subnetMask = 128;\n    this.v4 = false;\n    this.zone = ''; // #region Attributes\n\n    /**\n     * Returns true if the given address is in the subnet of the current address\n     * @memberof Address6\n     * @instance\n     * @returns {boolean}\n     */\n\n    this.isInSubnet = common.isInSubnet;\n    /**\n     * Returns true if the address is correct, false otherwise\n     * @memberof Address6\n     * @instance\n     * @returns {boolean}\n     */\n\n    this.isCorrect = common.isCorrect(constants6.BITS);\n\n    if (optionalGroups === undefined) {\n      this.groups = constants6.GROUPS;\n    } else {\n      this.groups = optionalGroups;\n    }\n\n    this.address = address;\n    var subnet = constants6.RE_SUBNET_STRING.exec(address);\n\n    if (subnet) {\n      this.parsedSubnet = subnet[0].replace('/', '');\n      this.subnetMask = parseInt(this.parsedSubnet, 10);\n      this.subnet = \"/\" + this.subnetMask;\n\n      if (Number.isNaN(this.subnetMask) || this.subnetMask < 0 || this.subnetMask > constants6.BITS) {\n        throw new address_error_1.AddressError('Invalid subnet mask.');\n      }\n\n      address = address.replace(constants6.RE_SUBNET_STRING, '');\n    } else if (/\\//.test(address)) {\n      throw new address_error_1.AddressError('Invalid subnet mask.');\n    }\n\n    var zone = constants6.RE_ZONE_STRING.exec(address);\n\n    if (zone) {\n      this.zone = zone[0];\n      address = address.replace(constants6.RE_ZONE_STRING, '');\n    }\n\n    this.addressMinusSuffix = address;\n    this.parsedAddress = this.parse(this.addressMinusSuffix);\n  }\n\n  Address6.isValid = function (address) {\n    try {\n      // eslint-disable-next-line no-new\n      new Address6(address);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  };\n  /**\n   * Convert a BigInteger to a v6 address object\n   * @memberof Address6\n   * @static\n   * @param {BigInteger} bigInteger - a BigInteger to convert\n   * @returns {Address6}\n   * @example\n   * var bigInteger = new BigInteger('1000000000000');\n   * var address = Address6.fromBigInteger(bigInteger);\n   * address.correctForm(); // '::e8:d4a5:1000'\n   */\n\n\n  Address6.fromBigInteger = function (bigInteger) {\n    var hex = bigInteger.toString(16).padStart(32, '0');\n    var groups = [];\n    var i;\n\n    for (i = 0; i < constants6.GROUPS; i++) {\n      groups.push(hex.slice(i * 4, (i + 1) * 4));\n    }\n\n    return new Address6(groups.join(':'));\n  };\n  /**\n   * Convert a URL (with optional port number) to an address object\n   * @memberof Address6\n   * @static\n   * @param {string} url - a URL with optional port number\n   * @example\n   * var addressAndPort = Address6.fromURL('http://[ffff::]:8080/foo/');\n   * addressAndPort.address.correctForm(); // 'ffff::'\n   * addressAndPort.port; // 8080\n   */\n\n\n  Address6.fromURL = function (url) {\n    var host;\n    var port = null;\n    var result; // If we have brackets parse them and find a port\n\n    if (url.indexOf('[') !== -1 && url.indexOf(']:') !== -1) {\n      result = constants6.RE_URL_WITH_PORT.exec(url);\n\n      if (result === null) {\n        return {\n          error: 'failed to parse address with port',\n          address: null,\n          port: null\n        };\n      }\n\n      host = result[1];\n      port = result[2]; // If there's a URL extract the address\n    } else if (url.indexOf('/') !== -1) {\n      // Remove the protocol prefix\n      url = url.replace(/^[a-z0-9]+:\\/\\//, ''); // Parse the address\n\n      result = constants6.RE_URL.exec(url);\n\n      if (result === null) {\n        return {\n          error: 'failed to parse address from URL',\n          address: null,\n          port: null\n        };\n      }\n\n      host = result[1]; // Otherwise just assign the URL to the host and let the library parse it\n    } else {\n      host = url;\n    } // If there's a port convert it to an integer\n\n\n    if (port) {\n      port = parseInt(port, 10); // squelch out of range ports\n\n      if (port < 0 || port > 65536) {\n        port = null;\n      }\n    } else {\n      // Standardize `undefined` to `null`\n      port = null;\n    }\n\n    return {\n      address: new Address6(host),\n      port: port\n    };\n  };\n  /**\n   * Create an IPv6-mapped address given an IPv4 address\n   * @memberof Address6\n   * @static\n   * @param {string} address - An IPv4 address string\n   * @returns {Address6}\n   * @example\n   * var address = Address6.fromAddress4('192.168.0.1');\n   * address.correctForm(); // '::ffff:c0a8:1'\n   * address.to4in6(); // '::ffff:192.168.0.1'\n   */\n\n\n  Address6.fromAddress4 = function (address) {\n    var address4 = new ipv4_1.Address4(address);\n    var mask6 = constants6.BITS - (constants4.BITS - address4.subnetMask);\n    return new Address6(\"::ffff:\" + address4.correctForm() + \"/\" + mask6);\n  };\n  /**\n   * Return an address from ip6.arpa form\n   * @memberof Address6\n   * @static\n   * @param {string} arpaFormAddress - an 'ip6.arpa' form address\n   * @returns {Adress6}\n   * @example\n   * var address = Address6.fromArpa(e.f.f.f.3.c.2.6.f.f.f.e.6.6.8.e.1.0.6.7.9.4.e.c.0.0.0.0.1.0.0.2.ip6.arpa.)\n   * address.correctForm(); // '2001:0:ce49:7601:e866:efff:62c3:fffe'\n   */\n\n\n  Address6.fromArpa = function (arpaFormAddress) {\n    // remove ending \".ip6.arpa.\" or just \".\"\n    var address = arpaFormAddress.replace(/(\\.ip6\\.arpa)?\\.$/, '');\n    var semicolonAmount = 7; // correct ip6.arpa form with ending removed will be 63 characters\n\n    if (address.length !== 63) {\n      throw new address_error_1.AddressError(\"Invalid 'ip6.arpa' form.\");\n    }\n\n    var parts = address.split('.').reverse();\n\n    for (var i = semicolonAmount; i > 0; i--) {\n      var insertIndex = i * 4;\n      parts.splice(insertIndex, 0, ':');\n    }\n\n    address = parts.join('');\n    return new Address6(address);\n  };\n  /**\n   * Return the Microsoft UNC transcription of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String} the Microsoft UNC transcription of the address\n   */\n\n\n  Address6.prototype.microsoftTranscription = function () {\n    return sprintf_js_1.sprintf('%s.ipv6-literal.net', this.correctForm().replace(/:/g, '-'));\n  };\n  /**\n   * Return the first n bits of the address, defaulting to the subnet mask\n   * @memberof Address6\n   * @instance\n   * @param {number} [mask=subnet] - the number of bits to mask\n   * @returns {String} the first n bits of the address as a string\n   */\n\n\n  Address6.prototype.mask = function (mask) {\n    if (mask === void 0) {\n      mask = this.subnetMask;\n    }\n\n    return this.getBitsBase2(0, mask);\n  };\n  /**\n   * Return the number of possible subnets of a given size in the address\n   * @memberof Address6\n   * @instance\n   * @param {number} [size=128] - the subnet size\n   * @returns {String}\n   */\n  // TODO: probably useful to have a numeric version of this too\n\n\n  Address6.prototype.possibleSubnets = function (subnetSize) {\n    if (subnetSize === void 0) {\n      subnetSize = 128;\n    }\n\n    var availableBits = constants6.BITS - this.subnetMask;\n    var subnetBits = Math.abs(subnetSize - constants6.BITS);\n    var subnetPowers = availableBits - subnetBits;\n\n    if (subnetPowers < 0) {\n      return '0';\n    }\n\n    return addCommas(new jsbn_1.BigInteger('2', 10).pow(subnetPowers).toString(10));\n  };\n  /**\n   * Helper function getting start address.\n   * @memberof Address6\n   * @instance\n   * @returns {BigInteger}\n   */\n\n\n  Address6.prototype._startAddress = function () {\n    return new jsbn_1.BigInteger(this.mask() + '0'.repeat(constants6.BITS - this.subnetMask), 2);\n  };\n  /**\n   * The first address in the range given by this address' subnet\n   * Often referred to as the Network Address.\n   * @memberof Address6\n   * @instance\n   * @returns {Address6}\n   */\n\n\n  Address6.prototype.startAddress = function () {\n    return Address6.fromBigInteger(this._startAddress());\n  };\n  /**\n   * The first host address in the range given by this address's subnet ie\n   * the first address after the Network Address\n   * @memberof Address6\n   * @instance\n   * @returns {Address6}\n   */\n\n\n  Address6.prototype.startAddressExclusive = function () {\n    var adjust = new jsbn_1.BigInteger('1');\n    return Address6.fromBigInteger(this._startAddress().add(adjust));\n  };\n  /**\n   * Helper function getting end address.\n   * @memberof Address6\n   * @instance\n   * @returns {BigInteger}\n   */\n\n\n  Address6.prototype._endAddress = function () {\n    return new jsbn_1.BigInteger(this.mask() + '1'.repeat(constants6.BITS - this.subnetMask), 2);\n  };\n  /**\n   * The last address in the range given by this address' subnet\n   * Often referred to as the Broadcast\n   * @memberof Address6\n   * @instance\n   * @returns {Address6}\n   */\n\n\n  Address6.prototype.endAddress = function () {\n    return Address6.fromBigInteger(this._endAddress());\n  };\n  /**\n   * The last host address in the range given by this address's subnet ie\n   * the last address prior to the Broadcast Address\n   * @memberof Address6\n   * @instance\n   * @returns {Address6}\n   */\n\n\n  Address6.prototype.endAddressExclusive = function () {\n    var adjust = new jsbn_1.BigInteger('1');\n    return Address6.fromBigInteger(this._endAddress().subtract(adjust));\n  };\n  /**\n   * Return the scope of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.getScope = function () {\n    var scope = constants6.SCOPES[this.getBits(12, 16).intValue()];\n\n    if (this.getType() === 'Global unicast' && scope !== 'Link local') {\n      scope = 'Global';\n    }\n\n    return scope || 'Unknown';\n  };\n  /**\n   * Return the type of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.getType = function () {\n    for (var _i = 0, _a = Object.keys(constants6.TYPES); _i < _a.length; _i++) {\n      var subnet = _a[_i];\n\n      if (this.isInSubnet(new Address6(subnet))) {\n        return constants6.TYPES[subnet];\n      }\n    }\n\n    return 'Global unicast';\n  };\n  /**\n   * Return the bits in the given range as a BigInteger\n   * @memberof Address6\n   * @instance\n   * @returns {BigInteger}\n   */\n\n\n  Address6.prototype.getBits = function (start, end) {\n    return new jsbn_1.BigInteger(this.getBitsBase2(start, end), 2);\n  };\n  /**\n   * Return the bits in the given range as a base-2 string\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.getBitsBase2 = function (start, end) {\n    return this.binaryZeroPad().slice(start, end);\n  };\n  /**\n   * Return the bits in the given range as a base-16 string\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.getBitsBase16 = function (start, end) {\n    var length = end - start;\n\n    if (length % 4 !== 0) {\n      throw new Error('Length of bits to retrieve must be divisible by four');\n    }\n\n    return this.getBits(start, end).toString(16).padStart(length / 4, '0');\n  };\n  /**\n   * Return the bits that are set past the subnet mask length\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.getBitsPastSubnet = function () {\n    return this.getBitsBase2(this.subnetMask, constants6.BITS);\n  };\n  /**\n   * Return the reversed ip6.arpa form of the address\n   * @memberof Address6\n   * @param {Object} options\n   * @param {boolean} options.omitSuffix - omit the \"ip6.arpa\" suffix\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.reverseForm = function (options) {\n    if (!options) {\n      options = {};\n    }\n\n    var characters = Math.floor(this.subnetMask / 4);\n    var reversed = this.canonicalForm().replace(/:/g, '').split('').slice(0, characters).reverse().join('.');\n\n    if (characters > 0) {\n      if (options.omitSuffix) {\n        return reversed;\n      }\n\n      return sprintf_js_1.sprintf('%s.ip6.arpa.', reversed);\n    }\n\n    if (options.omitSuffix) {\n      return '';\n    }\n\n    return 'ip6.arpa.';\n  };\n  /**\n   * Return the correct form of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.correctForm = function () {\n    var i;\n    var groups = [];\n    var zeroCounter = 0;\n    var zeroes = [];\n\n    for (i = 0; i < this.parsedAddress.length; i++) {\n      var value = parseInt(this.parsedAddress[i], 16);\n\n      if (value === 0) {\n        zeroCounter++;\n      }\n\n      if (value !== 0 && zeroCounter > 0) {\n        if (zeroCounter > 1) {\n          zeroes.push([i - zeroCounter, i - 1]);\n        }\n\n        zeroCounter = 0;\n      }\n    } // Do we end with a string of zeroes?\n\n\n    if (zeroCounter > 1) {\n      zeroes.push([this.parsedAddress.length - zeroCounter, this.parsedAddress.length - 1]);\n    }\n\n    var zeroLengths = zeroes.map(function (n) {\n      return n[1] - n[0] + 1;\n    });\n\n    if (zeroes.length > 0) {\n      var index = zeroLengths.indexOf(Math.max.apply(Math, zeroLengths));\n      groups = compact(this.parsedAddress, zeroes[index]);\n    } else {\n      groups = this.parsedAddress;\n    }\n\n    for (i = 0; i < groups.length; i++) {\n      if (groups[i] !== 'compact') {\n        groups[i] = parseInt(groups[i], 16).toString(16);\n      }\n    }\n\n    var correct = groups.join(':');\n    correct = correct.replace(/^compact$/, '::');\n    correct = correct.replace(/^compact|compact$/, ':');\n    correct = correct.replace(/compact/, '');\n    return correct;\n  };\n  /**\n   * Return a zero-padded base-2 string representation of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   * @example\n   * var address = new Address6('2001:4860:4001:803::1011');\n   * address.binaryZeroPad();\n   * // '0010000000000001010010000110000001000000000000010000100000000011\n   * //  0000000000000000000000000000000000000000000000000001000000010001'\n   */\n\n\n  Address6.prototype.binaryZeroPad = function () {\n    return this.bigInteger().toString(2).padStart(constants6.BITS, '0');\n  }; // TODO: Improve the semantics of this helper function\n\n\n  Address6.prototype.parse4in6 = function (address) {\n    var groups = address.split(':');\n    var lastGroup = groups.slice(-1)[0];\n    var address4 = lastGroup.match(constants4.RE_ADDRESS);\n\n    if (address4) {\n      this.parsedAddress4 = address4[0];\n      this.address4 = new ipv4_1.Address4(this.parsedAddress4);\n\n      for (var i = 0; i < this.address4.groups; i++) {\n        if (/^0[0-9]+/.test(this.address4.parsedAddress[i])) {\n          throw new address_error_1.AddressError(\"IPv4 addresses can't have leading zeroes.\", address.replace(constants4.RE_ADDRESS, this.address4.parsedAddress.map(spanLeadingZeroes4).join('.')));\n        }\n      }\n\n      this.v4 = true;\n      groups[groups.length - 1] = this.address4.toGroup6();\n      address = groups.join(':');\n    }\n\n    return address;\n  }; // TODO: Make private?\n\n\n  Address6.prototype.parse = function (address) {\n    address = this.parse4in6(address);\n    var badCharacters = address.match(constants6.RE_BAD_CHARACTERS);\n\n    if (badCharacters) {\n      throw new address_error_1.AddressError(sprintf_js_1.sprintf('Bad character%s detected in address: %s', badCharacters.length > 1 ? 's' : '', badCharacters.join('')), address.replace(constants6.RE_BAD_CHARACTERS, '<span class=\"parse-error\">$1</span>'));\n    }\n\n    var badAddress = address.match(constants6.RE_BAD_ADDRESS);\n\n    if (badAddress) {\n      throw new address_error_1.AddressError(sprintf_js_1.sprintf('Address failed regex: %s', badAddress.join('')), address.replace(constants6.RE_BAD_ADDRESS, '<span class=\"parse-error\">$1</span>'));\n    }\n\n    var groups = [];\n    var halves = address.split('::');\n\n    if (halves.length === 2) {\n      var first = halves[0].split(':');\n      var last = halves[1].split(':');\n\n      if (first.length === 1 && first[0] === '') {\n        first = [];\n      }\n\n      if (last.length === 1 && last[0] === '') {\n        last = [];\n      }\n\n      var remaining = this.groups - (first.length + last.length);\n\n      if (!remaining) {\n        throw new address_error_1.AddressError('Error parsing groups');\n      }\n\n      this.elidedGroups = remaining;\n      this.elisionBegin = first.length;\n      this.elisionEnd = first.length + this.elidedGroups;\n      groups = groups.concat(first);\n\n      for (var i = 0; i < remaining; i++) {\n        groups.push('0');\n      }\n\n      groups = groups.concat(last);\n    } else if (halves.length === 1) {\n      groups = address.split(':');\n      this.elidedGroups = 0;\n    } else {\n      throw new address_error_1.AddressError('Too many :: groups found');\n    }\n\n    groups = groups.map(function (group) {\n      return sprintf_js_1.sprintf('%x', parseInt(group, 16));\n    });\n\n    if (groups.length !== this.groups) {\n      throw new address_error_1.AddressError('Incorrect number of groups found');\n    }\n\n    return groups;\n  };\n  /**\n   * Return the canonical form of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.canonicalForm = function () {\n    return this.parsedAddress.map(paddedHex).join(':');\n  };\n  /**\n   * Return the decimal form of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.decimal = function () {\n    return this.parsedAddress.map(function (n) {\n      return sprintf_js_1.sprintf('%05d', parseInt(n, 16));\n    }).join(':');\n  };\n  /**\n   * Return the address as a BigInteger\n   * @memberof Address6\n   * @instance\n   * @returns {BigInteger}\n   */\n\n\n  Address6.prototype.bigInteger = function () {\n    return new jsbn_1.BigInteger(this.parsedAddress.map(paddedHex).join(''), 16);\n  };\n  /**\n   * Return the last two groups of this address as an IPv4 address string\n   * @memberof Address6\n   * @instance\n   * @returns {Address4}\n   * @example\n   * var address = new Address6('2001:4860:4001::1825:bf11');\n   * address.to4().correctForm(); // '24.37.191.17'\n   */\n\n\n  Address6.prototype.to4 = function () {\n    var binary = this.binaryZeroPad().split('');\n    return ipv4_1.Address4.fromHex(new jsbn_1.BigInteger(binary.slice(96, 128).join(''), 2).toString(16));\n  };\n  /**\n   * Return the v4-in-v6 form of the address\n   * @memberof Address6\n   * @instance\n   * @returns {String}\n   */\n\n\n  Address6.prototype.to4in6 = function () {\n    var address4 = this.to4();\n    var address6 = new Address6(this.parsedAddress.slice(0, 6).join(':'), 6);\n    var correct = address6.correctForm();\n    var infix = '';\n\n    if (!/:$/.test(correct)) {\n      infix = ':';\n    }\n\n    return correct + infix + address4.address;\n  };\n  /**\n   * Return an object containing the Teredo properties of the address\n   * @memberof Address6\n   * @instance\n   * @returns {Object}\n   */\n\n\n  Address6.prototype.inspectTeredo = function () {\n    /*\n    - Bits 0 to 31 are set to the Teredo prefix (normally 2001:0000::/32).\n    - Bits 32 to 63 embed the primary IPv4 address of the Teredo server that\n      is used.\n    - Bits 64 to 79 can be used to define some flags. Currently only the\n      higher order bit is used; it is set to 1 if the Teredo client is\n      located behind a cone NAT, 0 otherwise. For Microsoft's Windows Vista\n      and Windows Server 2008 implementations, more bits are used. In those\n      implementations, the format for these 16 bits is \"CRAAAAUG AAAAAAAA\",\n      where \"C\" remains the \"Cone\" flag. The \"R\" bit is reserved for future\n      use. The \"U\" bit is for the Universal/Local flag (set to 0). The \"G\" bit\n      is Individual/Group flag (set to 0). The A bits are set to a 12-bit\n      randomly generated number chosen by the Teredo client to introduce\n      additional protection for the Teredo node against IPv6-based scanning\n      attacks.\n    - Bits 80 to 95 contains the obfuscated UDP port number. This is the\n      port number that is mapped by the NAT to the Teredo client with all\n      bits inverted.\n    - Bits 96 to 127 contains the obfuscated IPv4 address. This is the\n      public IPv4 address of the NAT with all bits inverted.\n    */\n    var prefix = this.getBitsBase16(0, 32);\n    var udpPort = this.getBits(80, 96).xor(new jsbn_1.BigInteger('ffff', 16)).toString();\n    var server4 = ipv4_1.Address4.fromHex(this.getBitsBase16(32, 64));\n    var client4 = ipv4_1.Address4.fromHex(this.getBits(96, 128).xor(new jsbn_1.BigInteger('ffffffff', 16)).toString(16));\n    var flags = this.getBits(64, 80);\n    var flagsBase2 = this.getBitsBase2(64, 80);\n    var coneNat = flags.testBit(15);\n    var reserved = flags.testBit(14);\n    var groupIndividual = flags.testBit(8);\n    var universalLocal = flags.testBit(9);\n    var nonce = new jsbn_1.BigInteger(flagsBase2.slice(2, 6) + flagsBase2.slice(8, 16), 2).toString(10);\n    return {\n      prefix: sprintf_js_1.sprintf('%s:%s', prefix.slice(0, 4), prefix.slice(4, 8)),\n      server4: server4.address,\n      client4: client4.address,\n      flags: flagsBase2,\n      coneNat: coneNat,\n      microsoft: {\n        reserved: reserved,\n        universalLocal: universalLocal,\n        groupIndividual: groupIndividual,\n        nonce: nonce\n      },\n      udpPort: udpPort\n    };\n  };\n  /**\n   * Return an object containing the 6to4 properties of the address\n   * @memberof Address6\n   * @instance\n   * @returns {Object}\n   */\n\n\n  Address6.prototype.inspect6to4 = function () {\n    /*\n    - Bits 0 to 15 are set to the 6to4 prefix (2002::/16).\n    - Bits 16 to 48 embed the IPv4 address of the 6to4 gateway that is used.\n    */\n    var prefix = this.getBitsBase16(0, 16);\n    var gateway = ipv4_1.Address4.fromHex(this.getBitsBase16(16, 48));\n    return {\n      prefix: sprintf_js_1.sprintf('%s', prefix.slice(0, 4)),\n      gateway: gateway.address\n    };\n  };\n  /**\n   * Return a v6 6to4 address from a v6 v4inv6 address\n   * @memberof Address6\n   * @instance\n   * @returns {Address6}\n   */\n\n\n  Address6.prototype.to6to4 = function () {\n    if (!this.is4()) {\n      return null;\n    }\n\n    var addr6to4 = ['2002', this.getBitsBase16(96, 112), this.getBitsBase16(112, 128), '', '/16'].join(':');\n    return new Address6(addr6to4);\n  };\n  /**\n   * Return a byte array\n   * @memberof Address6\n   * @instance\n   * @returns {Array}\n   */\n\n\n  Address6.prototype.toByteArray = function () {\n    var byteArray = this.bigInteger().toByteArray(); // work around issue where `toByteArray` returns a leading 0 element\n\n    if (byteArray.length === 17 && byteArray[0] === 0) {\n      return byteArray.slice(1);\n    }\n\n    return byteArray;\n  };\n  /**\n   * Return an unsigned byte array\n   * @memberof Address6\n   * @instance\n   * @returns {Array}\n   */\n\n\n  Address6.prototype.toUnsignedByteArray = function () {\n    return this.toByteArray().map(unsignByte);\n  };\n  /**\n   * Convert a byte array to an Address6 object\n   * @memberof Address6\n   * @static\n   * @returns {Address6}\n   */\n\n\n  Address6.fromByteArray = function (bytes) {\n    return this.fromUnsignedByteArray(bytes.map(unsignByte));\n  };\n  /**\n   * Convert an unsigned byte array to an Address6 object\n   * @memberof Address6\n   * @static\n   * @returns {Address6}\n   */\n\n\n  Address6.fromUnsignedByteArray = function (bytes) {\n    var BYTE_MAX = new jsbn_1.BigInteger('256', 10);\n    var result = new jsbn_1.BigInteger('0', 10);\n    var multiplier = new jsbn_1.BigInteger('1', 10);\n\n    for (var i = bytes.length - 1; i >= 0; i--) {\n      result = result.add(multiplier.multiply(new jsbn_1.BigInteger(bytes[i].toString(10), 10)));\n      multiplier = multiplier.multiply(BYTE_MAX);\n    }\n\n    return Address6.fromBigInteger(result);\n  };\n  /**\n   * Returns true if the address is in the canonical form, false otherwise\n   * @memberof Address6\n   * @instance\n   * @returns {boolean}\n   */\n\n\n  Address6.prototype.isCanonical = function () {\n    return this.addressMinusSuffix === this.canonicalForm();\n  };\n  /**\n   * Returns true if the address is a link local address, false otherwise\n   * @memberof Address6\n   * @instance\n   * @returns {boolean}\n   */\n\n\n  Address6.prototype.isLinkLocal = function () {\n    // Zeroes are required, i.e. we can't check isInSubnet with 'fe80::/10'\n    if (this.getBitsBase2(0, 64) === '1111111010000000000000000000000000000000000000000000000000000000') {\n      return true;\n    }\n\n    return false;\n  };\n  /**\n   * Returns true if the address is a multicast address, false otherwise\n   * @memberof Address6\n   * @instance\n   * @returns {boolean}\n   */\n\n\n  Address6.prototype.isMulticast = function () {\n    return this.getType() === 'Multicast';\n  };\n  /**\n   * Returns true if the address is a v4-in-v6 address, false otherwise\n   * @memberof Address6\n   * @instance\n   * @returns {boolean}\n   */\n\n\n  Address6.prototype.is4 = function () {\n    return this.v4;\n  };\n  /**\n   * Returns true if the address is a Teredo address, false otherwise\n   * @memberof Address6\n   * @instance\n   * @returns {boolean}\n   */\n\n\n  Address6.prototype.isTeredo = function () {\n    return this.isInSubnet(new Address6('2001::/32'));\n  };\n  /**\n   * Returns true if the address is a 6to4 address, false otherwise\n   * @memberof Address6\n   * @instance\n   * @returns {boolean}\n   */\n\n\n  Address6.prototype.is6to4 = function () {\n    return this.isInSubnet(new Address6('2002::/16'));\n  };\n  /**\n   * Returns true if the address is a loopback address, false otherwise\n   * @memberof Address6\n   * @instance\n   * @returns {boolean}\n   */\n\n\n  Address6.prototype.isLoopback = function () {\n    return this.getType() === 'Loopback';\n  }; // #endregion\n  // #region HTML\n\n  /**\n   * @returns {String} the address in link form with a default port of 80\n   */\n\n\n  Address6.prototype.href = function (optionalPort) {\n    if (optionalPort === undefined) {\n      optionalPort = '';\n    } else {\n      optionalPort = sprintf_js_1.sprintf(':%s', optionalPort);\n    }\n\n    return sprintf_js_1.sprintf('http://[%s]%s/', this.correctForm(), optionalPort);\n  };\n  /**\n   * @returns {String} a link suitable for conveying the address via a URL hash\n   */\n\n\n  Address6.prototype.link = function (options) {\n    if (!options) {\n      options = {};\n    }\n\n    if (options.className === undefined) {\n      options.className = '';\n    }\n\n    if (options.prefix === undefined) {\n      options.prefix = '/#address=';\n    }\n\n    if (options.v4 === undefined) {\n      options.v4 = false;\n    }\n\n    var formFunction = this.correctForm;\n\n    if (options.v4) {\n      formFunction = this.to4in6;\n    }\n\n    if (options.className) {\n      return sprintf_js_1.sprintf('<a href=\"%1$s%2$s\" class=\"%3$s\">%2$s</a>', options.prefix, formFunction.call(this), options.className);\n    }\n\n    return sprintf_js_1.sprintf('<a href=\"%1$s%2$s\">%2$s</a>', options.prefix, formFunction.call(this));\n  };\n  /**\n   * Groups an address\n   * @returns {String}\n   */\n\n\n  Address6.prototype.group = function () {\n    if (this.elidedGroups === 0) {\n      // The simple case\n      return helpers.simpleGroup(this.address).join(':');\n    }\n\n    assert(typeof this.elidedGroups === 'number');\n    assert(typeof this.elisionBegin === 'number'); // The elided case\n\n    var output = [];\n\n    var _a = this.address.split('::'),\n        left = _a[0],\n        right = _a[1];\n\n    if (left.length) {\n      output.push.apply(output, helpers.simpleGroup(left));\n    } else {\n      output.push('');\n    }\n\n    var classes = ['hover-group'];\n\n    for (var i = this.elisionBegin; i < this.elisionBegin + this.elidedGroups; i++) {\n      classes.push(sprintf_js_1.sprintf('group-%d', i));\n    }\n\n    output.push(sprintf_js_1.sprintf('<span class=\"%s\"></span>', classes.join(' ')));\n\n    if (right.length) {\n      output.push.apply(output, helpers.simpleGroup(right, this.elisionEnd));\n    } else {\n      output.push('');\n    }\n\n    if (this.is4()) {\n      assert(this.address4 instanceof ipv4_1.Address4);\n      output.pop();\n      output.push(this.address4.groupForV6());\n    }\n\n    return output.join(':');\n  }; // #endregion\n  // #region Regular expressions\n\n  /**\n   * Generate a regular expression string that can be used to find or validate\n   * all variations of this address\n   * @memberof Address6\n   * @instance\n   * @param {boolean} substringSearch\n   * @returns {string}\n   */\n\n\n  Address6.prototype.regularExpressionString = function (substringSearch) {\n    if (substringSearch === void 0) {\n      substringSearch = false;\n    }\n\n    var output = []; // TODO: revisit why this is necessary\n\n    var address6 = new Address6(this.correctForm());\n\n    if (address6.elidedGroups === 0) {\n      // The simple case\n      output.push(regular_expressions_1.simpleRegularExpression(address6.parsedAddress));\n    } else if (address6.elidedGroups === constants6.GROUPS) {\n      // A completely elided address\n      output.push(regular_expressions_1.possibleElisions(constants6.GROUPS));\n    } else {\n      // A partially elided address\n      var halves = address6.address.split('::');\n\n      if (halves[0].length) {\n        output.push(regular_expressions_1.simpleRegularExpression(halves[0].split(':')));\n      }\n\n      assert(typeof address6.elidedGroups === 'number');\n      output.push(regular_expressions_1.possibleElisions(address6.elidedGroups, halves[0].length !== 0, halves[1].length !== 0));\n\n      if (halves[1].length) {\n        output.push(regular_expressions_1.simpleRegularExpression(halves[1].split(':')));\n      }\n\n      output = [output.join(':')];\n    }\n\n    if (!substringSearch) {\n      output = __spreadArray(__spreadArray(['(?=^|', regular_expressions_1.ADDRESS_BOUNDARY, '|[^\\\\w\\\\:])('], output), [')(?=[^\\\\w\\\\:]|', regular_expressions_1.ADDRESS_BOUNDARY, '|$)']);\n    }\n\n    return output.join('');\n  };\n  /**\n   * Generate a regular expression that can be used to find or validate all\n   * variations of this address.\n   * @memberof Address6\n   * @instance\n   * @param {boolean} substringSearch\n   * @returns {RegExp}\n   */\n\n\n  Address6.prototype.regularExpression = function (substringSearch) {\n    if (substringSearch === void 0) {\n      substringSearch = false;\n    }\n\n    return new RegExp(this.regularExpressionString(substringSearch), 'i');\n  };\n\n  return Address6;\n}();\n\nexports.Address6 = Address6;","map":{"version":3,"mappings":";AAAA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAKA;;AACA;;AACA;;AAEA,SAASA,MAAT,CAAgBC,SAAhB,EAA8B;EAC5B,IAAI,CAACA,SAAL,EAAgB;IACd,MAAM,IAAIC,KAAJ,CAAU,mBAAV,CAAN;EACD;AACF;;AAED,SAASC,SAAT,CAAmBC,MAAnB,EAAiC;EAC/B,IAAMC,CAAC,GAAG,cAAV;;EAEA,OAAOA,CAAC,CAACC,IAAF,CAAOF,MAAP,CAAP,EAAuB;IACrBA,MAAM,GAAGA,MAAM,CAACG,OAAP,CAAeF,CAAf,EAAkB,OAAlB,CAAT;EACD;;EAED,OAAOD,MAAP;AACD;;AAED,SAASI,kBAAT,CAA4BC,CAA5B,EAAqC;EACnCA,CAAC,GAAGA,CAAC,CAACF,OAAF,CAAU,mBAAV,EAA+B,uCAA/B,CAAJ;EACAE,CAAC,GAAGA,CAAC,CAACF,OAAF,CAAU,cAAV,EAA0B,uCAA1B,CAAJ;EAEA,OAAOE,CAAP;AACD;AAED;;;;;AAGA,SAASC,OAAT,CAAiBC,OAAjB,EAAoCC,KAApC,EAAmD;EACjD,IAAMC,EAAE,GAAG,EAAX;EACA,IAAMC,EAAE,GAAG,EAAX;EACA,IAAIC,CAAJ;;EAEA,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGJ,OAAO,CAACK,MAAxB,EAAgCD,CAAC,EAAjC,EAAqC;IACnC,IAAIA,CAAC,GAAGH,KAAK,CAAC,CAAD,CAAb,EAAkB;MAChBC,EAAE,CAACI,IAAH,CAAQN,OAAO,CAACI,CAAD,CAAf;IACD,CAFD,MAEO,IAAIA,CAAC,GAAGH,KAAK,CAAC,CAAD,CAAb,EAAkB;MACvBE,EAAE,CAACG,IAAH,CAAQN,OAAO,CAACI,CAAD,CAAf;IACD;EACF;;EAED,OAAOF,EAAE,CAACK,MAAH,CAAU,CAAC,SAAD,CAAV,EAAuBA,MAAvB,CAA8BJ,EAA9B,CAAP;AACD;;AAED,SAASK,SAAT,CAAmBC,KAAnB,EAAgC;EAC9B,OAAOC,qBAAQ,MAAR,EAAgBC,QAAQ,CAACF,KAAD,EAAQ,EAAR,CAAxB,CAAP;AACD;;AAED,SAASG,UAAT,CAAoBC,CAApB,EAA6B;EAC3B;EACA,OAAOA,CAAC,GAAG,IAAX;AACD;AAuBD;;;;;;;;;;AAQA;AAAA;AAAA;EAgBE,kBAAYb,OAAZ,EAA6Bc,cAA7B,EAAoD;IAbpD,0BAA6B,EAA7B;IAOA,oBAAuB,EAAvB;IACA,cAAiB,MAAjB;IACA,kBAAqB,GAArB;IACA,UAAc,KAAd;IACA,YAAe,EAAf,CAEoD,CAk0BpD;;IACA;;;;;;;IAMA,kBAAaC,MAAM,CAACC,UAApB;IAEA;;;;;;;IAMA,iBAAYD,MAAM,CAACE,SAAP,CAAiBC,UAAU,CAACC,IAA5B,CAAZ;;IAh1BE,IAAIL,cAAc,KAAKM,SAAvB,EAAkC;MAChC,KAAKC,MAAL,GAAcH,UAAU,CAACI,MAAzB;IACD,CAFD,MAEO;MACL,KAAKD,MAAL,GAAcP,cAAd;IACD;;IAED,KAAKd,OAAL,GAAeA,OAAf;IAEA,IAAMuB,MAAM,GAAGL,UAAU,CAACM,gBAAX,CAA4BC,IAA5B,CAAiCzB,OAAjC,CAAf;;IAEA,IAAIuB,MAAJ,EAAY;MACV,KAAKG,YAAL,GAAoBH,MAAM,CAAC,CAAD,CAAN,CAAU3B,OAAV,CAAkB,GAAlB,EAAuB,EAAvB,CAApB;MACA,KAAK+B,UAAL,GAAkBhB,QAAQ,CAAC,KAAKe,YAAN,EAAoB,EAApB,CAA1B;MACA,KAAKH,MAAL,GAAc,MAAI,KAAKI,UAAvB;;MAEA,IACEC,MAAM,CAACC,KAAP,CAAa,KAAKF,UAAlB,KACA,KAAKA,UAAL,GAAkB,CADlB,IAEA,KAAKA,UAAL,GAAkBT,UAAU,CAACC,IAH/B,EAIE;QACA,MAAM,IAAIW,4BAAJ,CAAiB,sBAAjB,CAAN;MACD;;MAED9B,OAAO,GAAGA,OAAO,CAACJ,OAAR,CAAgBsB,UAAU,CAACM,gBAA3B,EAA6C,EAA7C,CAAV;IACD,CAdD,MAcO,IAAI,KAAK7B,IAAL,CAAUK,OAAV,CAAJ,EAAwB;MAC7B,MAAM,IAAI8B,4BAAJ,CAAiB,sBAAjB,CAAN;IACD;;IAED,IAAMC,IAAI,GAAGb,UAAU,CAACc,cAAX,CAA0BP,IAA1B,CAA+BzB,OAA/B,CAAb;;IAEA,IAAI+B,IAAJ,EAAU;MACR,KAAKA,IAAL,GAAYA,IAAI,CAAC,CAAD,CAAhB;MAEA/B,OAAO,GAAGA,OAAO,CAACJ,OAAR,CAAgBsB,UAAU,CAACc,cAA3B,EAA2C,EAA3C,CAAV;IACD;;IAED,KAAKC,kBAAL,GAA0BjC,OAA1B;IAEA,KAAKkC,aAAL,GAAqB,KAAKC,KAAL,CAAW,KAAKF,kBAAhB,CAArB;EACD;;EAEMG,mBAAP,UAAepC,OAAf,EAA8B;IAC5B,IAAI;MACF;MACA,IAAIoC,QAAJ,CAAapC,OAAb;MAEA,OAAO,IAAP;IACD,CALD,CAKE,OAAOqC,CAAP,EAAU;MACV,OAAO,KAAP;IACD;EACF,CATM;EAWP;;;;;;;;;;;;;EAWOD,0BAAP,UAAsBE,UAAtB,EAA4C;IAC1C,IAAMC,GAAG,GAAGD,UAAU,CAACE,QAAX,CAAoB,EAApB,EAAwBC,QAAxB,CAAiC,EAAjC,EAAqC,GAArC,CAAZ;IACA,IAAMpB,MAAM,GAAG,EAAf;IACA,IAAIjB,CAAJ;;IAEA,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGc,UAAU,CAACI,MAA3B,EAAmClB,CAAC,EAApC,EAAwC;MACtCiB,MAAM,CAACf,IAAP,CAAYiC,GAAG,CAACtC,KAAJ,CAAUG,CAAC,GAAG,CAAd,EAAiB,CAACA,CAAC,GAAG,CAAL,IAAU,CAA3B,CAAZ;IACD;;IAED,OAAO,IAAIgC,QAAJ,CAAaf,MAAM,CAACqB,IAAP,CAAY,GAAZ,CAAb,CAAP;EACD,CAVM;EAYP;;;;;;;;;;;;EAUON,mBAAP,UAAeO,GAAf,EAA0B;IACxB,IAAIC,IAAJ;IACA,IAAIC,IAAI,GAA2B,IAAnC;IACA,IAAIC,MAAJ,CAHwB,CAKxB;;IACA,IAAIH,GAAG,CAACI,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAAtB,IAA2BJ,GAAG,CAACI,OAAJ,CAAY,IAAZ,MAAsB,CAAC,CAAtD,EAAyD;MACvDD,MAAM,GAAG5B,UAAU,CAAC8B,gBAAX,CAA4BvB,IAA5B,CAAiCkB,GAAjC,CAAT;;MAEA,IAAIG,MAAM,KAAK,IAAf,EAAqB;QACnB,OAAO;UACLG,KAAK,EAAE,mCADF;UAELjD,OAAO,EAAE,IAFJ;UAGL6C,IAAI,EAAE;QAHD,CAAP;MAKD;;MAEDD,IAAI,GAAGE,MAAM,CAAC,CAAD,CAAb;MACAD,IAAI,GAAGC,MAAM,CAAC,CAAD,CAAb,CAZuD,CAavD;IACD,CAdD,MAcO,IAAIH,GAAG,CAACI,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAA1B,EAA6B;MAClC;MACAJ,GAAG,GAAGA,GAAG,CAAC/C,OAAJ,CAAY,iBAAZ,EAA+B,EAA/B,CAAN,CAFkC,CAIlC;;MACAkD,MAAM,GAAG5B,UAAU,CAACgC,MAAX,CAAkBzB,IAAlB,CAAuBkB,GAAvB,CAAT;;MAEA,IAAIG,MAAM,KAAK,IAAf,EAAqB;QACnB,OAAO;UACLG,KAAK,EAAE,kCADF;UAELjD,OAAO,EAAE,IAFJ;UAGL6C,IAAI,EAAE;QAHD,CAAP;MAKD;;MAEDD,IAAI,GAAGE,MAAM,CAAC,CAAD,CAAb,CAfkC,CAgBlC;IACD,CAjBM,MAiBA;MACLF,IAAI,GAAGD,GAAP;IACD,CAvCuB,CAyCxB;;;IACA,IAAIE,IAAJ,EAAU;MACRA,IAAI,GAAGlC,QAAQ,CAACkC,IAAD,EAAO,EAAP,CAAf,CADQ,CAGR;;MACA,IAAIA,IAAI,GAAG,CAAP,IAAYA,IAAI,GAAG,KAAvB,EAA8B;QAC5BA,IAAI,GAAG,IAAP;MACD;IACF,CAPD,MAOO;MACL;MACAA,IAAI,GAAG,IAAP;IACD;;IAED,OAAO;MACL7C,OAAO,EAAE,IAAIoC,QAAJ,CAAaQ,IAAb,CADJ;MAELC,IAAI;IAFC,CAAP;EAID,CA1DM;EA4DP;;;;;;;;;;;;;EAWOT,wBAAP,UAAoBpC,OAApB,EAAmC;IACjC,IAAMmD,QAAQ,GAAG,IAAIC,eAAJ,CAAapD,OAAb,CAAjB;IAEA,IAAMqD,KAAK,GAAGnC,UAAU,CAACC,IAAX,IAAmBmC,UAAU,CAACnC,IAAX,GAAkBgC,QAAQ,CAACxB,UAA9C,CAAd;IAEA,OAAO,IAAIS,QAAJ,CAAa,YAAUe,QAAQ,CAACI,WAAT,EAAV,GAAgC,GAAhC,GAAoCF,KAAjD,CAAP;EACD,CANM;EAQP;;;;;;;;;;;;EAUOjB,oBAAP,UAAgBoB,eAAhB,EAAuC;IACrC;IACA,IAAIxD,OAAO,GAAGwD,eAAe,CAAC5D,OAAhB,CAAwB,mBAAxB,EAA6C,EAA7C,CAAd;IACA,IAAM6D,eAAe,GAAG,CAAxB,CAHqC,CAKrC;;IACA,IAAIzD,OAAO,CAACK,MAAR,KAAmB,EAAvB,EAA2B;MACzB,MAAM,IAAIyB,4BAAJ,CAAiB,0BAAjB,CAAN;IACD;;IAED,IAAM4B,KAAK,GAAG1D,OAAO,CAAC2D,KAAR,CAAc,GAAd,EAAmBC,OAAnB,EAAd;;IAEA,KAAK,IAAIxD,CAAC,GAAGqD,eAAb,EAA8BrD,CAAC,GAAG,CAAlC,EAAqCA,CAAC,EAAtC,EAA0C;MACxC,IAAMyD,WAAW,GAAGzD,CAAC,GAAG,CAAxB;MACAsD,KAAK,CAACI,MAAN,CAAaD,WAAb,EAA0B,CAA1B,EAA6B,GAA7B;IACD;;IAED7D,OAAO,GAAG0D,KAAK,CAAChB,IAAN,CAAW,EAAX,CAAV;IAEA,OAAO,IAAIN,QAAJ,CAAapC,OAAb,CAAP;EACD,CApBM;EAsBP;;;;;;;;EAMAoC;IACE,OAAO1B,qBAAQ,qBAAR,EAA+B,KAAK6C,WAAL,GAAmB3D,OAAnB,CAA2B,IAA3B,EAAiC,GAAjC,CAA/B,CAAP;EACD,CAFD;EAIA;;;;;;;;;EAOAwC,oCAAK2B,IAAL,EAAmC;IAA9B;MAAAA,OAAe,KAAKpC,UAApB;IAA8B;;IACjC,OAAO,KAAKqC,YAAL,CAAkB,CAAlB,EAAqBD,IAArB,CAAP;EACD,CAFD;EAIA;;;;;;;EAOA;;;EACA3B,+CAAgB6B,UAAhB,EAAwC;IAAxB;MAAAA;IAAwB;;IACtC,IAAMC,aAAa,GAAGhD,UAAU,CAACC,IAAX,GAAkB,KAAKQ,UAA7C;IACA,IAAMwC,UAAU,GAAGC,IAAI,CAACC,GAAL,CAASJ,UAAU,GAAG/C,UAAU,CAACC,IAAjC,CAAnB;IACA,IAAMmD,YAAY,GAAGJ,aAAa,GAAGC,UAArC;;IAEA,IAAIG,YAAY,GAAG,CAAnB,EAAsB;MACpB,OAAO,GAAP;IACD;;IAED,OAAO9E,SAAS,CAAC,IAAI+E,iBAAJ,CAAe,GAAf,EAAoB,EAApB,EAAwBC,GAAxB,CAA4BF,YAA5B,EAA0C9B,QAA1C,CAAmD,EAAnD,CAAD,CAAhB;EACD,CAVD;EAYA;;;;;;;;EAMAJ;IACE,OAAO,IAAImC,iBAAJ,CAAe,KAAKR,IAAL,KAAc,IAAIU,MAAJ,CAAWvD,UAAU,CAACC,IAAX,GAAkB,KAAKQ,UAAlC,CAA7B,EAA4E,CAA5E,CAAP;EACD,CAFD;EAIA;;;;;;;;;EAOAS;IACE,OAAOA,QAAQ,CAACsC,cAAT,CAAwB,KAAKC,aAAL,EAAxB,CAAP;EACD,CAFD;EAIA;;;;;;;;;EAOAvC;IACE,IAAMwC,MAAM,GAAG,IAAIL,iBAAJ,CAAe,GAAf,CAAf;IACA,OAAOnC,QAAQ,CAACsC,cAAT,CAAwB,KAAKC,aAAL,GAAqBE,GAArB,CAAyBD,MAAzB,CAAxB,CAAP;EACD,CAHD;EAKA;;;;;;;;EAMAxC;IACE,OAAO,IAAImC,iBAAJ,CAAe,KAAKR,IAAL,KAAc,IAAIU,MAAJ,CAAWvD,UAAU,CAACC,IAAX,GAAkB,KAAKQ,UAAlC,CAA7B,EAA4E,CAA5E,CAAP;EACD,CAFD;EAIA;;;;;;;;;EAOAS;IACE,OAAOA,QAAQ,CAACsC,cAAT,CAAwB,KAAKI,WAAL,EAAxB,CAAP;EACD,CAFD;EAIA;;;;;;;;;EAOA1C;IACE,IAAMwC,MAAM,GAAG,IAAIL,iBAAJ,CAAe,GAAf,CAAf;IACA,OAAOnC,QAAQ,CAACsC,cAAT,CAAwB,KAAKI,WAAL,GAAmBC,QAAnB,CAA4BH,MAA5B,CAAxB,CAAP;EACD,CAHD;EAKA;;;;;;;;EAMAxC;IACE,IAAI4C,KAAK,GAAG9D,UAAU,CAAC+D,MAAX,CAAkB,KAAKC,OAAL,CAAa,EAAb,EAAiB,EAAjB,EAAqBC,QAArB,EAAlB,CAAZ;;IAEA,IAAI,KAAKC,OAAL,OAAmB,gBAAnB,IAAuCJ,KAAK,KAAK,YAArD,EAAmE;MACjEA,KAAK,GAAG,QAAR;IACD;;IAED,OAAOA,KAAK,IAAI,SAAhB;EACD,CARD;EAUA;;;;;;;;EAMA5C;IACE,KAAqB,uBAAM,CAACiD,IAAP,CAAYnE,UAAU,CAACoE,KAAvB,CAArB,EAAqBC,cAArB,EAAqBA,IAArB,EAAoD;MAA/C,IAAMhE,MAAM,SAAZ;;MACH,IAAI,KAAKP,UAAL,CAAgB,IAAIoB,QAAJ,CAAab,MAAb,CAAhB,CAAJ,EAA2C;QACzC,OAAOL,UAAU,CAACoE,KAAX,CAAiB/D,MAAjB,CAAP;MACD;IACF;;IAED,OAAO,gBAAP;EACD,CARD;EAUA;;;;;;;;EAMAa,uCAAQoD,KAAR,EAAuBC,GAAvB,EAAkC;IAChC,OAAO,IAAIlB,iBAAJ,CAAe,KAAKP,YAAL,CAAkBwB,KAAlB,EAAyBC,GAAzB,CAAf,EAA8C,CAA9C,CAAP;EACD,CAFD;EAIA;;;;;;;;EAMArD,4CAAaoD,KAAb,EAA4BC,GAA5B,EAAuC;IACrC,OAAO,KAAKC,aAAL,GAAqBzF,KAArB,CAA2BuF,KAA3B,EAAkCC,GAAlC,CAAP;EACD,CAFD;EAIA;;;;;;;;EAMArD,6CAAcoD,KAAd,EAA6BC,GAA7B,EAAwC;IACtC,IAAMpF,MAAM,GAAGoF,GAAG,GAAGD,KAArB;;IAEA,IAAInF,MAAM,GAAG,CAAT,KAAe,CAAnB,EAAsB;MACpB,MAAM,IAAId,KAAJ,CAAU,sDAAV,CAAN;IACD;;IAED,OAAO,KAAK2F,OAAL,CAAaM,KAAb,EAAoBC,GAApB,EACJjD,QADI,CACK,EADL,EAEJC,QAFI,CAEKpC,MAAM,GAAG,CAFd,EAEiB,GAFjB,CAAP;EAGD,CAVD;EAYA;;;;;;;;EAMA+B;IACE,OAAO,KAAK4B,YAAL,CAAkB,KAAKrC,UAAvB,EAAmCT,UAAU,CAACC,IAA9C,CAAP;EACD,CAFD;EAIA;;;;;;;;;;EAQAiB,2CAAYuD,OAAZ,EAA+C;IAC7C,IAAI,CAACA,OAAL,EAAc;MACZA,OAAO,GAAG,EAAV;IACD;;IAED,IAAMC,UAAU,GAAGxB,IAAI,CAACyB,KAAL,CAAW,KAAKlE,UAAL,GAAkB,CAA7B,CAAnB;IAEA,IAAMmE,QAAQ,GAAG,KAAKC,aAAL,GACdnG,OADc,CACN,IADM,EACA,EADA,EAEd+D,KAFc,CAER,EAFQ,EAGd1D,KAHc,CAGR,CAHQ,EAGL2F,UAHK,EAIdhC,OAJc,GAKdlB,IALc,CAKT,GALS,CAAjB;;IAOA,IAAIkD,UAAU,GAAG,CAAjB,EAAoB;MAClB,IAAID,OAAO,CAACK,UAAZ,EAAwB;QACtB,OAAOF,QAAP;MACD;;MAED,OAAOpF,qBAAQ,cAAR,EAAwBoF,QAAxB,CAAP;IACD;;IAED,IAAIH,OAAO,CAACK,UAAZ,EAAwB;MACtB,OAAO,EAAP;IACD;;IAED,OAAO,WAAP;EACD,CA3BD;EA6BA;;;;;;;;EAMA5D;IACE,IAAIhC,CAAJ;IACA,IAAIiB,MAAM,GAAG,EAAb;IAEA,IAAI4E,WAAW,GAAG,CAAlB;IACA,IAAMC,MAAM,GAAG,EAAf;;IAEA,KAAK9F,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAG,KAAK8B,aAAL,CAAmB7B,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;MAC9C,IAAM+F,KAAK,GAAGxF,QAAQ,CAAC,KAAKuB,aAAL,CAAmB9B,CAAnB,CAAD,EAAwB,EAAxB,CAAtB;;MAEA,IAAI+F,KAAK,KAAK,CAAd,EAAiB;QACfF,WAAW;MACZ;;MAED,IAAIE,KAAK,KAAK,CAAV,IAAeF,WAAW,GAAG,CAAjC,EAAoC;QAClC,IAAIA,WAAW,GAAG,CAAlB,EAAqB;UACnBC,MAAM,CAAC5F,IAAP,CAAY,CAACF,CAAC,GAAG6F,WAAL,EAAkB7F,CAAC,GAAG,CAAtB,CAAZ;QACD;;QAED6F,WAAW,GAAG,CAAd;MACD;IACF,CArBH,CAuBE;;;IACA,IAAIA,WAAW,GAAG,CAAlB,EAAqB;MACnBC,MAAM,CAAC5F,IAAP,CAAY,CAAC,KAAK4B,aAAL,CAAmB7B,MAAnB,GAA4B4F,WAA7B,EAA0C,KAAK/D,aAAL,CAAmB7B,MAAnB,GAA4B,CAAtE,CAAZ;IACD;;IAED,IAAM+F,WAAW,GAAGF,MAAM,CAACG,GAAP,CAAW,UAACvG,CAAD,EAAE;MAAK,QAAC,CAAC,CAAD,CAAD,GAAOA,CAAC,CAAC,CAAD,CAAR,GAAc,CAAd;IAAe,CAAjC,CAApB;;IAEA,IAAIoG,MAAM,CAAC7F,MAAP,GAAgB,CAApB,EAAuB;MACrB,IAAMiG,KAAK,GAAGF,WAAW,CAACrD,OAAZ,CAAoBqB,IAAI,CAACmC,GAAL,CAAQC,KAAR,OAAYJ,WAAZ,CAApB,CAAd;MAEA/E,MAAM,GAAGtB,OAAO,CAAC,KAAKmC,aAAN,EAAqBgE,MAAM,CAACI,KAAD,CAA3B,CAAhB;IACD,CAJD,MAIO;MACLjF,MAAM,GAAG,KAAKa,aAAd;IACD;;IAED,KAAK9B,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGiB,MAAM,CAAChB,MAAvB,EAA+BD,CAAC,EAAhC,EAAoC;MAClC,IAAIiB,MAAM,CAACjB,CAAD,CAAN,KAAc,SAAlB,EAA6B;QAC3BiB,MAAM,CAACjB,CAAD,CAAN,GAAYO,QAAQ,CAACU,MAAM,CAACjB,CAAD,CAAP,EAAY,EAAZ,CAAR,CAAwBoC,QAAxB,CAAiC,EAAjC,CAAZ;MACD;IACF;;IAED,IAAIiE,OAAO,GAAGpF,MAAM,CAACqB,IAAP,CAAY,GAAZ,CAAd;IAEA+D,OAAO,GAAGA,OAAO,CAAC7G,OAAR,CAAgB,WAAhB,EAA6B,IAA7B,CAAV;IACA6G,OAAO,GAAGA,OAAO,CAAC7G,OAAR,CAAgB,mBAAhB,EAAqC,GAArC,CAAV;IACA6G,OAAO,GAAGA,OAAO,CAAC7G,OAAR,CAAgB,SAAhB,EAA2B,EAA3B,CAAV;IAEA,OAAO6G,OAAP;EACD,CAnDD;EAqDA;;;;;;;;;;;;;EAWArE;IACE,OAAO,KAAKE,UAAL,GAAkBE,QAAlB,CAA2B,CAA3B,EAA8BC,QAA9B,CAAuCvB,UAAU,CAACC,IAAlD,EAAwD,GAAxD,CAAP;EACD,CAFD,CA3fF,CA+fE;;;EACAiB,yCAAUpC,OAAV,EAAyB;IACvB,IAAMqB,MAAM,GAAGrB,OAAO,CAAC2D,KAAR,CAAc,GAAd,CAAf;IACA,IAAM+C,SAAS,GAAGrF,MAAM,CAACpB,KAAP,CAAa,CAAC,CAAd,EAAiB,CAAjB,CAAlB;IAEA,IAAMkD,QAAQ,GAAGuD,SAAS,CAACC,KAAV,CAAgBrD,UAAU,CAACsD,UAA3B,CAAjB;;IAEA,IAAIzD,QAAJ,EAAc;MACZ,KAAK0D,cAAL,GAAsB1D,QAAQ,CAAC,CAAD,CAA9B;MACA,KAAKA,QAAL,GAAgB,IAAIC,eAAJ,CAAa,KAAKyD,cAAlB,CAAhB;;MAEA,KAAK,IAAIzG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK+C,QAAL,CAAc9B,MAAlC,EAA0CjB,CAAC,EAA3C,EAA+C;QAC7C,IAAI,WAAWT,IAAX,CAAgB,KAAKwD,QAAL,CAAcjB,aAAd,CAA4B9B,CAA5B,CAAhB,CAAJ,EAAqD;UACnD,MAAM,IAAI0B,4BAAJ,CACJ,2CADI,EAEJ9B,OAAO,CAACJ,OAAR,CACE0D,UAAU,CAACsD,UADb,EAEE,KAAKzD,QAAL,CAAcjB,aAAd,CAA4BmE,GAA5B,CAAgCxG,kBAAhC,EAAoD6C,IAApD,CAAyD,GAAzD,CAFF,CAFI,CAAN;QAOD;MACF;;MAED,KAAKoE,EAAL,GAAU,IAAV;MAEAzF,MAAM,CAACA,MAAM,CAAChB,MAAP,GAAgB,CAAjB,CAAN,GAA4B,KAAK8C,QAAL,CAAc4D,QAAd,EAA5B;MAEA/G,OAAO,GAAGqB,MAAM,CAACqB,IAAP,CAAY,GAAZ,CAAV;IACD;;IAED,OAAO1C,OAAP;EACD,CA9BD,CAhgBF,CAgiBE;;;EACAoC,qCAAMpC,OAAN,EAAqB;IACnBA,OAAO,GAAG,KAAKgH,SAAL,CAAehH,OAAf,CAAV;IAEA,IAAMiH,aAAa,GAAGjH,OAAO,CAAC2G,KAAR,CAAczF,UAAU,CAACgG,iBAAzB,CAAtB;;IAEA,IAAID,aAAJ,EAAmB;MACjB,MAAM,IAAInF,4BAAJ,CACJpB,qBACE,yCADF,EAEEuG,aAAa,CAAC5G,MAAd,GAAuB,CAAvB,GAA2B,GAA3B,GAAiC,EAFnC,EAGE4G,aAAa,CAACvE,IAAd,CAAmB,EAAnB,CAHF,CADI,EAMJ1C,OAAO,CAACJ,OAAR,CAAgBsB,UAAU,CAACgG,iBAA3B,EAA8C,qCAA9C,CANI,CAAN;IAQD;;IAED,IAAMC,UAAU,GAAGnH,OAAO,CAAC2G,KAAR,CAAczF,UAAU,CAACkG,cAAzB,CAAnB;;IAEA,IAAID,UAAJ,EAAgB;MACd,MAAM,IAAIrF,4BAAJ,CACJpB,qBAAQ,0BAAR,EAAoCyG,UAAU,CAACzE,IAAX,CAAgB,EAAhB,CAApC,CADI,EAEJ1C,OAAO,CAACJ,OAAR,CAAgBsB,UAAU,CAACkG,cAA3B,EAA2C,qCAA3C,CAFI,CAAN;IAID;;IAED,IAAI/F,MAAM,GAAa,EAAvB;IAEA,IAAMgG,MAAM,GAAGrH,OAAO,CAAC2D,KAAR,CAAc,IAAd,CAAf;;IAEA,IAAI0D,MAAM,CAAChH,MAAP,KAAkB,CAAtB,EAAyB;MACvB,IAAIiH,KAAK,GAAGD,MAAM,CAAC,CAAD,CAAN,CAAU1D,KAAV,CAAgB,GAAhB,CAAZ;MACA,IAAI4D,IAAI,GAAGF,MAAM,CAAC,CAAD,CAAN,CAAU1D,KAAV,CAAgB,GAAhB,CAAX;;MAEA,IAAI2D,KAAK,CAACjH,MAAN,KAAiB,CAAjB,IAAsBiH,KAAK,CAAC,CAAD,CAAL,KAAa,EAAvC,EAA2C;QACzCA,KAAK,GAAG,EAAR;MACD;;MAED,IAAIC,IAAI,CAAClH,MAAL,KAAgB,CAAhB,IAAqBkH,IAAI,CAAC,CAAD,CAAJ,KAAY,EAArC,EAAyC;QACvCA,IAAI,GAAG,EAAP;MACD;;MAED,IAAMC,SAAS,GAAG,KAAKnG,MAAL,IAAeiG,KAAK,CAACjH,MAAN,GAAekH,IAAI,CAAClH,MAAnC,CAAlB;;MAEA,IAAI,CAACmH,SAAL,EAAgB;QACd,MAAM,IAAI1F,4BAAJ,CAAiB,sBAAjB,CAAN;MACD;;MAED,KAAK2F,YAAL,GAAoBD,SAApB;MAEA,KAAKE,YAAL,GAAoBJ,KAAK,CAACjH,MAA1B;MACA,KAAKsH,UAAL,GAAkBL,KAAK,CAACjH,MAAN,GAAe,KAAKoH,YAAtC;MAEApG,MAAM,GAAGA,MAAM,CAACd,MAAP,CAAc+G,KAAd,CAAT;;MAEA,KAAK,IAAIlH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoH,SAApB,EAA+BpH,CAAC,EAAhC,EAAoC;QAClCiB,MAAM,CAACf,IAAP,CAAY,GAAZ;MACD;;MAEDe,MAAM,GAAGA,MAAM,CAACd,MAAP,CAAcgH,IAAd,CAAT;IACD,CA9BD,MA8BO,IAAIF,MAAM,CAAChH,MAAP,KAAkB,CAAtB,EAAyB;MAC9BgB,MAAM,GAAGrB,OAAO,CAAC2D,KAAR,CAAc,GAAd,CAAT;MAEA,KAAK8D,YAAL,GAAoB,CAApB;IACD,CAJM,MAIA;MACL,MAAM,IAAI3F,4BAAJ,CAAiB,0BAAjB,CAAN;IACD;;IAEDT,MAAM,GAAGA,MAAM,CAACgF,GAAP,CAAW,UAACuB,KAAD,EAAc;MAAK,4BAAQ,IAAR,EAAcjH,QAAQ,CAACiH,KAAD,EAAQ,EAAR,CAAtB;IAAkC,CAAhE,CAAT;;IAEA,IAAIvG,MAAM,CAAChB,MAAP,KAAkB,KAAKgB,MAA3B,EAAmC;MACjC,MAAM,IAAIS,4BAAJ,CAAiB,kCAAjB,CAAN;IACD;;IAED,OAAOT,MAAP;EACD,CA1ED;EA4EA;;;;;;;;EAMAe;IACE,OAAO,KAAKF,aAAL,CAAmBmE,GAAnB,CAAuB7F,SAAvB,EAAkCkC,IAAlC,CAAuC,GAAvC,CAAP;EACD,CAFD;EAIA;;;;;;;;EAMAN;IACE,OAAO,KAAKF,aAAL,CAAmBmE,GAAnB,CAAuB,UAACvG,CAAD,EAAE;MAAK,4BAAQ,MAAR,EAAgBa,QAAQ,CAACb,CAAD,EAAI,EAAJ,CAAxB;IAAgC,CAA9D,EAAgE4C,IAAhE,CAAqE,GAArE,CAAP;EACD,CAFD;EAIA;;;;;;;;EAMAN;IACE,OAAO,IAAImC,iBAAJ,CAAe,KAAKrC,aAAL,CAAmBmE,GAAnB,CAAuB7F,SAAvB,EAAkCkC,IAAlC,CAAuC,EAAvC,CAAf,EAA2D,EAA3D,CAAP;EACD,CAFD;EAIA;;;;;;;;;;;EASAN;IACE,IAAMyF,MAAM,GAAG,KAAKnC,aAAL,GAAqB/B,KAArB,CAA2B,EAA3B,CAAf;IAEA,OAAOP,gBAAS0E,OAAT,CAAiB,IAAIvD,iBAAJ,CAAesD,MAAM,CAAC5H,KAAP,CAAa,EAAb,EAAiB,GAAjB,EAAsByC,IAAtB,CAA2B,EAA3B,CAAf,EAA+C,CAA/C,EAAkDF,QAAlD,CAA2D,EAA3D,CAAjB,CAAP;EACD,CAJD;EAMA;;;;;;;;EAMAJ;IACE,IAAMe,QAAQ,GAAG,KAAK4E,GAAL,EAAjB;IACA,IAAMC,QAAQ,GAAG,IAAI5F,QAAJ,CAAa,KAAKF,aAAL,CAAmBjC,KAAnB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+ByC,IAA/B,CAAoC,GAApC,CAAb,EAAuD,CAAvD,CAAjB;IAEA,IAAM+D,OAAO,GAAGuB,QAAQ,CAACzE,WAAT,EAAhB;IAEA,IAAI0E,KAAK,GAAG,EAAZ;;IAEA,IAAI,CAAC,KAAKtI,IAAL,CAAU8G,OAAV,CAAL,EAAyB;MACvBwB,KAAK,GAAG,GAAR;IACD;;IAED,OAAOxB,OAAO,GAAGwB,KAAV,GAAkB9E,QAAQ,CAACnD,OAAlC;EACD,CAbD;EAeA;;;;;;;;EAMAoC;IACE;;;;;;;;;;;;;;;;;;;;;IAqBA,IAAM8F,MAAM,GAAG,KAAKC,aAAL,CAAmB,CAAnB,EAAsB,EAAtB,CAAf;IAEA,IAAMC,OAAO,GAAG,KAAKlD,OAAL,CAAa,EAAb,EAAiB,EAAjB,EAAqBmD,GAArB,CAAyB,IAAI9D,iBAAJ,CAAe,MAAf,EAAuB,EAAvB,CAAzB,EAAqD/B,QAArD,EAAhB;IAEA,IAAM8F,OAAO,GAAGlF,gBAAS0E,OAAT,CAAiB,KAAKK,aAAL,CAAmB,EAAnB,EAAuB,EAAvB,CAAjB,CAAhB;IACA,IAAMI,OAAO,GAAGnF,gBAAS0E,OAAT,CACd,KAAK5C,OAAL,CAAa,EAAb,EAAiB,GAAjB,EAAsBmD,GAAtB,CAA0B,IAAI9D,iBAAJ,CAAe,UAAf,EAA2B,EAA3B,CAA1B,EAA0D/B,QAA1D,CAAmE,EAAnE,CADc,CAAhB;IAIA,IAAMgG,KAAK,GAAG,KAAKtD,OAAL,CAAa,EAAb,EAAiB,EAAjB,CAAd;IACA,IAAMuD,UAAU,GAAG,KAAKzE,YAAL,CAAkB,EAAlB,EAAsB,EAAtB,CAAnB;IAEA,IAAM0E,OAAO,GAAGF,KAAK,CAACG,OAAN,CAAc,EAAd,CAAhB;IACA,IAAMC,QAAQ,GAAGJ,KAAK,CAACG,OAAN,CAAc,EAAd,CAAjB;IACA,IAAME,eAAe,GAAGL,KAAK,CAACG,OAAN,CAAc,CAAd,CAAxB;IACA,IAAMG,cAAc,GAAGN,KAAK,CAACG,OAAN,CAAc,CAAd,CAAvB;IACA,IAAMI,KAAK,GAAG,IAAIxE,iBAAJ,CAAekE,UAAU,CAACxI,KAAX,CAAiB,CAAjB,EAAoB,CAApB,IAAyBwI,UAAU,CAACxI,KAAX,CAAiB,CAAjB,EAAoB,EAApB,CAAxC,EAAiE,CAAjE,EAAoEuC,QAApE,CAA6E,EAA7E,CAAd;IAEA,OAAO;MACL0F,MAAM,EAAExH,qBAAQ,OAAR,EAAiBwH,MAAM,CAACjI,KAAP,CAAa,CAAb,EAAgB,CAAhB,CAAjB,EAAqCiI,MAAM,CAACjI,KAAP,CAAa,CAAb,EAAgB,CAAhB,CAArC,CADH;MAELqI,OAAO,EAAEA,OAAO,CAACtI,OAFZ;MAGLuI,OAAO,EAAEA,OAAO,CAACvI,OAHZ;MAILwI,KAAK,EAAEC,UAJF;MAKLC,OAAO,SALF;MAMLM,SAAS,EAAE;QACTJ,QAAQ,UADC;QAETE,cAAc,gBAFL;QAGTD,eAAe,iBAHN;QAITE,KAAK;MAJI,CANN;MAYLX,OAAO;IAZF,CAAP;EAcD,CAtDD;EAwDA;;;;;;;;EAMAhG;IACE;;;;IAKA,IAAM8F,MAAM,GAAG,KAAKC,aAAL,CAAmB,CAAnB,EAAsB,EAAtB,CAAf;IAEA,IAAMc,OAAO,GAAG7F,gBAAS0E,OAAT,CAAiB,KAAKK,aAAL,CAAmB,EAAnB,EAAuB,EAAvB,CAAjB,CAAhB;IAEA,OAAO;MACLD,MAAM,EAAExH,qBAAQ,IAAR,EAAcwH,MAAM,CAACjI,KAAP,CAAa,CAAb,EAAgB,CAAhB,CAAd,CADH;MAELgJ,OAAO,EAAEA,OAAO,CAACjJ;IAFZ,CAAP;EAID,CAdD;EAgBA;;;;;;;;EAMAoC;IACE,IAAI,CAAC,KAAK8G,GAAL,EAAL,EAAiB;MACf,OAAO,IAAP;IACD;;IAED,IAAMC,QAAQ,GAAG,CACf,MADe,EAEf,KAAKhB,aAAL,CAAmB,EAAnB,EAAuB,GAAvB,CAFe,EAGf,KAAKA,aAAL,CAAmB,GAAnB,EAAwB,GAAxB,CAHe,EAIf,EAJe,EAKf,KALe,EAMfzF,IANe,CAMV,GANU,CAAjB;IAQA,OAAO,IAAIN,QAAJ,CAAa+G,QAAb,CAAP;EACD,CAdD;EAgBA;;;;;;;;EAMA/G;IACE,IAAMgH,SAAS,GAAG,KAAK9G,UAAL,GAAkB+G,WAAlB,EAAlB,CADF,CAGE;;IACA,IAAID,SAAS,CAAC/I,MAAV,KAAqB,EAArB,IAA2B+I,SAAS,CAAC,CAAD,CAAT,KAAiB,CAAhD,EAAmD;MACjD,OAAOA,SAAS,CAACnJ,KAAV,CAAgB,CAAhB,CAAP;IACD;;IAED,OAAOmJ,SAAP;EACD,CATD;EAWA;;;;;;;;EAMAhH;IACE,OAAO,KAAKiH,WAAL,GAAmBhD,GAAnB,CAAuBzF,UAAvB,CAAP;EACD,CAFD;EAIA;;;;;;;;EAMOwB,yBAAP,UAAqBkH,KAArB,EAAsC;IACpC,OAAO,KAAKC,qBAAL,CAA2BD,KAAK,CAACjD,GAAN,CAAUzF,UAAV,CAA3B,CAAP;EACD,CAFM;EAIP;;;;;;;;EAMOwB,iCAAP,UAA6BkH,KAA7B,EAA8C;IAC5C,IAAME,QAAQ,GAAG,IAAIjF,iBAAJ,CAAe,KAAf,EAAsB,EAAtB,CAAjB;IACA,IAAIzB,MAAM,GAAG,IAAIyB,iBAAJ,CAAe,GAAf,EAAoB,EAApB,CAAb;IACA,IAAIkF,UAAU,GAAG,IAAIlF,iBAAJ,CAAe,GAAf,EAAoB,EAApB,CAAjB;;IAEA,KAAK,IAAInE,CAAC,GAAGkJ,KAAK,CAACjJ,MAAN,GAAe,CAA5B,EAA+BD,CAAC,IAAI,CAApC,EAAuCA,CAAC,EAAxC,EAA4C;MAC1C0C,MAAM,GAAGA,MAAM,CAAC+B,GAAP,CAAW4E,UAAU,CAACC,QAAX,CAAoB,IAAInF,iBAAJ,CAAe+E,KAAK,CAAClJ,CAAD,CAAL,CAASoC,QAAT,CAAkB,EAAlB,CAAf,EAAsC,EAAtC,CAApB,CAAX,CAAT;MAEAiH,UAAU,GAAGA,UAAU,CAACC,QAAX,CAAoBF,QAApB,CAAb;IACD;;IAED,OAAOpH,QAAQ,CAACsC,cAAT,CAAwB5B,MAAxB,CAAP;EACD,CAZM;EA+BP;;;;;;;;EAMAV;IACE,OAAO,KAAKH,kBAAL,KAA4B,KAAK8D,aAAL,EAAnC;EACD,CAFD;EAIA;;;;;;;;EAMA3D;IACE;IACA,IACE,KAAK4B,YAAL,CAAkB,CAAlB,EAAqB,EAArB,MACA,kEAFF,EAGE;MACA,OAAO,IAAP;IACD;;IAED,OAAO,KAAP;EACD,CAVD;EAYA;;;;;;;;EAMA5B;IACE,OAAO,KAAKgD,OAAL,OAAmB,WAA1B;EACD,CAFD;EAIA;;;;;;;;EAMAhD;IACE,OAAO,KAAK0E,EAAZ;EACD,CAFD;EAIA;;;;;;;;EAMA1E;IACE,OAAO,KAAKpB,UAAL,CAAgB,IAAIoB,QAAJ,CAAa,WAAb,CAAhB,CAAP;EACD,CAFD;EAIA;;;;;;;;EAMAA;IACE,OAAO,KAAKpB,UAAL,CAAgB,IAAIoB,QAAJ,CAAa,WAAb,CAAhB,CAAP;EACD,CAFD;EAIA;;;;;;;;EAMAA;IACE,OAAO,KAAKgD,OAAL,OAAmB,UAA1B;EACD,CAFD,CA76BF,CAg7BE;EAEA;;EACA;;;;;EAGAhD,oCAAKuH,YAAL,EAAmC;IACjC,IAAIA,YAAY,KAAKvI,SAArB,EAAgC;MAC9BuI,YAAY,GAAG,EAAf;IACD,CAFD,MAEO;MACLA,YAAY,GAAGjJ,qBAAQ,KAAR,EAAeiJ,YAAf,CAAf;IACD;;IAED,OAAOjJ,qBAAQ,gBAAR,EAA0B,KAAK6C,WAAL,EAA1B,EAA8CoG,YAA9C,CAAP;EACD,CARD;EAUA;;;;;EAGAvH,oCAAKuD,OAAL,EAAoE;IAClE,IAAI,CAACA,OAAL,EAAc;MACZA,OAAO,GAAG,EAAV;IACD;;IAED,IAAIA,OAAO,CAACiE,SAAR,KAAsBxI,SAA1B,EAAqC;MACnCuE,OAAO,CAACiE,SAAR,GAAoB,EAApB;IACD;;IAED,IAAIjE,OAAO,CAACuC,MAAR,KAAmB9G,SAAvB,EAAkC;MAChCuE,OAAO,CAACuC,MAAR,GAAiB,YAAjB;IACD;;IAED,IAAIvC,OAAO,CAACmB,EAAR,KAAe1F,SAAnB,EAA8B;MAC5BuE,OAAO,CAACmB,EAAR,GAAa,KAAb;IACD;;IAED,IAAI+C,YAAY,GAAG,KAAKtG,WAAxB;;IAEA,IAAIoC,OAAO,CAACmB,EAAZ,EAAgB;MACd+C,YAAY,GAAG,KAAKC,MAApB;IACD;;IAED,IAAInE,OAAO,CAACiE,SAAZ,EAAuB;MACrB,OAAOlJ,qBACL,0CADK,EAELiF,OAAO,CAACuC,MAFH,EAGL2B,YAAY,CAACE,IAAb,CAAkB,IAAlB,CAHK,EAILpE,OAAO,CAACiE,SAJH,CAAP;IAMD;;IAED,OAAOlJ,qBAAQ,6BAAR,EAAuCiF,OAAO,CAACuC,MAA/C,EAAuD2B,YAAY,CAACE,IAAb,CAAkB,IAAlB,CAAvD,CAAP;EACD,CAjCD;EAmCA;;;;;;EAIA3H;IACE,IAAI,KAAKqF,YAAL,KAAsB,CAA1B,EAA6B;MAC3B;MACA,OAAOuC,OAAO,CAACC,WAAR,CAAoB,KAAKjK,OAAzB,EAAkC0C,IAAlC,CAAuC,GAAvC,CAAP;IACD;;IAEDrD,MAAM,CAAC,OAAO,KAAKoI,YAAZ,KAA6B,QAA9B,CAAN;IACApI,MAAM,CAAC,OAAO,KAAKqI,YAAZ,KAA6B,QAA9B,CAAN,CAPF,CASE;;IACA,IAAMwC,MAAM,GAAG,EAAf;;IAEM,SAAgB,KAAKlK,OAAL,CAAa2D,KAAb,CAAmB,IAAnB,CAAhB;IAAA,IAACwG,IAAI,QAAL;IAAA,IAAOC,KAAK,QAAZ;;IAEN,IAAID,IAAI,CAAC9J,MAAT,EAAiB;MACf6J,MAAM,CAAC5J,IAAP,CAAWkG,KAAX,SAAewD,OAAO,CAACC,WAAR,CAAoBE,IAApB,CAAf;IACD,CAFD,MAEO;MACLD,MAAM,CAAC5J,IAAP,CAAY,EAAZ;IACD;;IAED,IAAM+J,OAAO,GAAG,CAAC,aAAD,CAAhB;;IAEA,KAAK,IAAIjK,CAAC,GAAG,KAAKsH,YAAlB,EAAgCtH,CAAC,GAAG,KAAKsH,YAAL,GAAoB,KAAKD,YAA7D,EAA2ErH,CAAC,EAA5E,EAAgF;MAC9EiK,OAAO,CAAC/J,IAAR,CAAaI,qBAAQ,UAAR,EAAoBN,CAApB,CAAb;IACD;;IAED8J,MAAM,CAAC5J,IAAP,CAAYI,qBAAQ,0BAAR,EAAoC2J,OAAO,CAAC3H,IAAR,CAAa,GAAb,CAApC,CAAZ;;IAEA,IAAI0H,KAAK,CAAC/J,MAAV,EAAkB;MAChB6J,MAAM,CAAC5J,IAAP,CAAWkG,KAAX,SAAewD,OAAO,CAACC,WAAR,CAAoBG,KAApB,EAA2B,KAAKzC,UAAhC,CAAf;IACD,CAFD,MAEO;MACLuC,MAAM,CAAC5J,IAAP,CAAY,EAAZ;IACD;;IAED,IAAI,KAAK4I,GAAL,EAAJ,EAAgB;MACd7J,MAAM,CAAC,KAAK8D,QAAL,YAAyBC,eAA1B,CAAN;MAEA8G,MAAM,CAACI,GAAP;MACAJ,MAAM,CAAC5J,IAAP,CAAY,KAAK6C,QAAL,CAAcoH,UAAd,EAAZ;IACD;;IAED,OAAOL,MAAM,CAACxH,IAAP,CAAY,GAAZ,CAAP;EACD,CA1CD,CA1+BF,CAqhCE;EAEA;;EACA;;;;;;;;;;EAQAN,uDAAwCoI,eAAxC,EAAwE;IAAhC;MAAAA;IAAgC;;IACtE,IAAIN,MAAM,GAAa,EAAvB,CADsE,CAGtE;;IACA,IAAMlC,QAAQ,GAAG,IAAI5F,QAAJ,CAAa,KAAKmB,WAAL,EAAb,CAAjB;;IAEA,IAAIyE,QAAQ,CAACP,YAAT,KAA0B,CAA9B,EAAiC;MAC/B;MACAyC,MAAM,CAAC5J,IAAP,CAAYmK,8CAAwBzC,QAAQ,CAAC9F,aAAjC,CAAZ;IACD,CAHD,MAGO,IAAI8F,QAAQ,CAACP,YAAT,KAA0BvG,UAAU,CAACI,MAAzC,EAAiD;MACtD;MACA4I,MAAM,CAAC5J,IAAP,CAAYmK,uCAAiBvJ,UAAU,CAACI,MAA5B,CAAZ;IACD,CAHM,MAGA;MACL;MACA,IAAM+F,MAAM,GAAGW,QAAQ,CAAChI,OAAT,CAAiB2D,KAAjB,CAAuB,IAAvB,CAAf;;MAEA,IAAI0D,MAAM,CAAC,CAAD,CAAN,CAAUhH,MAAd,EAAsB;QACpB6J,MAAM,CAAC5J,IAAP,CAAYmK,8CAAwBpD,MAAM,CAAC,CAAD,CAAN,CAAU1D,KAAV,CAAgB,GAAhB,CAAxB,CAAZ;MACD;;MAEDtE,MAAM,CAAC,OAAO2I,QAAQ,CAACP,YAAhB,KAAiC,QAAlC,CAAN;MAEAyC,MAAM,CAAC5J,IAAP,CACEmK,uCAAiBzC,QAAQ,CAACP,YAA1B,EAAwCJ,MAAM,CAAC,CAAD,CAAN,CAAUhH,MAAV,KAAqB,CAA7D,EAAgEgH,MAAM,CAAC,CAAD,CAAN,CAAUhH,MAAV,KAAqB,CAArF,CADF;;MAIA,IAAIgH,MAAM,CAAC,CAAD,CAAN,CAAUhH,MAAd,EAAsB;QACpB6J,MAAM,CAAC5J,IAAP,CAAYmK,8CAAwBpD,MAAM,CAAC,CAAD,CAAN,CAAU1D,KAAV,CAAgB,GAAhB,CAAxB,CAAZ;MACD;;MAEDuG,MAAM,GAAG,CAACA,MAAM,CAACxH,IAAP,CAAY,GAAZ,CAAD,CAAT;IACD;;IAED,IAAI,CAAC8H,eAAL,EAAsB;MACpBN,MAAM,gCACJ,OADI,EAEJO,sCAFI,EAGJ,cAHI,GAIDP,MAJC,GAIK,CACT,gBADS,EAETO,sCAFS,EAGT,KAHS,CAJL,CAAN;IASD;;IAED,OAAOP,MAAM,CAACxH,IAAP,CAAY,EAAZ,CAAP;EACD,CA9CD;EAgDA;;;;;;;;;;EAQAN,iDAAkCoI,eAAlC,EAAkE;IAAhC;MAAAA;IAAgC;;IAChE,OAAO,IAAIE,MAAJ,CAAW,KAAKC,uBAAL,CAA6BH,eAA7B,CAAX,EAA0D,GAA1D,CAAP;EACD,CAFD;;EAIF;AAAC,CA5lCD;;AAAaI","names":["assert","condition","Error","addCommas","number","r","test","replace","spanLeadingZeroes4","n","compact","address","slice","s1","s2","i","length","push","concat","paddedHex","octet","sprintf_js_1","parseInt","unsignByte","b","optionalGroups","common","isInSubnet","isCorrect","constants6","BITS","undefined","groups","GROUPS","subnet","RE_SUBNET_STRING","exec","parsedSubnet","subnetMask","Number","isNaN","address_error_1","zone","RE_ZONE_STRING","addressMinusSuffix","parsedAddress","parse","Address6","e","bigInteger","hex","toString","padStart","join","url","host","port","result","indexOf","RE_URL_WITH_PORT","error","RE_URL","address4","ipv4_1","mask6","constants4","correctForm","arpaFormAddress","semicolonAmount","parts","split","reverse","insertIndex","splice","mask","getBitsBase2","subnetSize","availableBits","subnetBits","Math","abs","subnetPowers","jsbn_1","pow","repeat","fromBigInteger","_startAddress","adjust","add","_endAddress","subtract","scope","SCOPES","getBits","intValue","getType","keys","TYPES","_i","start","end","binaryZeroPad","options","characters","floor","reversed","canonicalForm","omitSuffix","zeroCounter","zeroes","value","zeroLengths","map","index","max","apply","correct","lastGroup","match","RE_ADDRESS","parsedAddress4","v4","toGroup6","parse4in6","badCharacters","RE_BAD_CHARACTERS","badAddress","RE_BAD_ADDRESS","halves","first","last","remaining","elidedGroups","elisionBegin","elisionEnd","group","binary","fromHex","to4","address6","infix","prefix","getBitsBase16","udpPort","xor","server4","client4","flags","flagsBase2","coneNat","testBit","reserved","groupIndividual","universalLocal","nonce","microsoft","gateway","is4","addr6to4","byteArray","toByteArray","bytes","fromUnsignedByteArray","BYTE_MAX","multiplier","multiply","optionalPort","className","formFunction","to4in6","call","helpers","simpleGroup","output","left","right","classes","pop","groupForV6","substringSearch","regular_expressions_1","RegExp","regularExpressionString","exports"],"sources":["../../../lib/ipv6.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}